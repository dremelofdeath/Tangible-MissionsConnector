var datePickerDivID="datepicker";var iFrameDivID="datepickeriframe";var dayArrayShort=new Array("Su","Mo","Tu","We","Th","Fr","Sa");var dayArrayMed=new Array("Sun","Mon","Tue","Wed","Thu","Fri","Sat");var dayArrayLong=new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday");var monthArrayShort=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec");var monthArrayMed=new Array("Jan","Feb","Mar","Apr","May","June","July","Aug","Sept","Oct","Nov","Dec");var monthArrayLong=new Array("January","February","March","April","May","June","July","August","September","October","November","December");var defaultDateSeparator="/";var defaultDateFormat="mdy";var dateSeparator=defaultDateSeparator;var dateFormat=defaultDateFormat;function displayDatePicker(c,g,b,f){var e=document.getElementsByName(c).item(0);if(!g){g=e}if(f){dateSeparator=f}else{dateSeparator=defaultDateSeparator}if(b){dateFormat=b}else{dateFormat=defaultDateFormat}var a=g.offsetLeft;var h=g.offsetTop+g.offsetHeight;var d=g;while(d.offsetParent){d=d.offsetParent;a+=d.offsetLeft;h+=d.offsetTop}drawDatePicker(e,a,h)}function drawDatePicker(d,a,f){var c=getFieldDate(d.value);if(!document.getElementById(datePickerDivID)){var b=document.createElement("div");b.setAttribute("id",datePickerDivID);b.setAttribute("class","dpDiv");b.setAttribute("style","visibility: hidden;");document.body.appendChild(b)}var e=document.getElementById(datePickerDivID);e.style.position="absolute";e.style.left=a+"px";e.style.top=f+"px";e.style.visibility=(e.style.visibility=="visible"?"hidden":"visible");e.style.display=(e.style.display=="block"?"none":"block");e.style.zIndex=10000;refreshDatePicker(d.name,c.getFullYear(),c.getMonth(),c.getDate())}function refreshDatePicker(t,o,y,u){var e=new Date();if((y>=0)&&(o>0)){e=new Date(o,y,1)}else{u=e.getDate();e.setDate(1)}var j="\r\n";var k="<table cols=7 class='dpTable'>"+j;var c="</table>"+j;var w="<tr class='dpTR'>";var f="<tr class='dpTitleTR'>";var l="<tr class='dpDayTR'>";var n="<tr class='dpTodayButtonTR'>";var g="</tr>"+j;var a="<td class='dpTD' onMouseOut='this.className=\"dpTD\";' onMouseOver=' this.className=\"dpTDHover\";' ";var b="<td colspan=5 class='dpTitleTD'>";var v="<td class='dpButtonTD'>";var A="<td colspan=7 class='dpTodayButtonTD'>";var r="<td class='dpDayTD'>";var z="<td class='dpDayHighlightTD' onMouseOut='this.className=\"dpDayHighlightTD\";' onMouseOver='this.className=\"dpTDHover\";' ";var q="</td>"+j;var d="<div class='dpTitleText'>";var s="<div class='dpDayHighlight'>";var p="</div>";var m=k;m+=f;m+=v+getButtonCode(t,e,-1,"&lt;")+q;m+=b+d+monthArrayLong[e.getMonth()]+" "+e.getFullYear()+p+q;m+=v+getButtonCode(t,e,1,"&gt;")+q;m+=g;m+=l;for(i=0;i<dayArrayShort.length;i++){m+=r+dayArrayShort[i]+q}m+=g;m+=w;for(i=0;i<e.getDay();i++){m+=a+"&nbsp;"+q}do{dayNum=e.getDate();TD_onclick=" onclick=\"updateDateField('"+t+"', '"+getDateString(e)+"');\">";if(dayNum==u){m+=z+TD_onclick+s+dayNum+p+q}else{m+=a+TD_onclick+dayNum+q}if(e.getDay()==6){m+=g+w}e.setDate(e.getDate()+1)}while(e.getDate()>1);if(e.getDay()>0){for(i=6;i>e.getDay();i--){m+=a+"&nbsp;"+q}}m+=g;var x=new Date();var h="Today is "+dayArrayMed[x.getDay()]+", "+monthArrayMed[x.getMonth()]+" "+x.getDate();m+=n+A;m+="<button class='dpTodayButton' onClick='refreshDatePicker(\""+t+"\");'>this month</button> ";m+="<button class='dpTodayButton' onClick='updateDateField(\""+t+"\");'>close</button>";m+=q+g;m+=c;document.getElementById(datePickerDivID).innerHTML=m;adjustiFrame()}function getButtonCode(a,b,e,d){var f=(b.getMonth()+e)%12;var c=b.getFullYear()+parseInt((b.getMonth()+e)/12);if(f<0){f+=12;c+=-1}return"<button class='dpButton' onClick='refreshDatePicker(\""+a+'", '+c+", "+f+");'>"+d+"</button>"}function getDateString(a){var c="00"+a.getDate();var b="00"+(a.getMonth()+1);c=c.substring(c.length-2);b=b.substring(b.length-2);switch(dateFormat){case"dmy":return c+dateSeparator+b+dateSeparator+a.getFullYear();case"ymd":return a.getFullYear()+dateSeparator+b+dateSeparator+c;case"mdy":default:return b+dateSeparator+c+dateSeparator+a.getFullYear()}}function getFieldDate(f){var b;var c;var h,a,j;try{c=splitDateString(f);if(c){switch(dateFormat){case"dmy":h=parseInt(c[0],10);a=parseInt(c[1],10)-1;j=parseInt(c[2],10);break;case"ymd":h=parseInt(c[2],10);a=parseInt(c[1],10)-1;j=parseInt(c[0],10);break;case"mdy":default:h=parseInt(c[1],10);a=parseInt(c[0],10)-1;j=parseInt(c[2],10);break}b=new Date(j,a,h)}else{if(f){b=new Date(f)}else{b=new Date()}}}catch(g){b=new Date()}return b}function splitDateString(b){var a;if(b.indexOf("/")>=0){a=b.split("/")}else{if(b.indexOf(".")>=0){a=b.split(".")}else{if(b.indexOf("-")>=0){a=b.split("-")}else{if(b.indexOf("\\")>=0){a=b.split("\\")}else{a=false}}}}return a}function updateDateField(a,b){var c=document.getElementsByName(a).item(0);if(b){c.value=b}var d=document.getElementById(datePickerDivID);d.style.visibility="hidden";d.style.display="none";adjustiFrame();c.focus();if((b)&&(typeof(datePickerClosed)=="function")){datePickerClosed(c)}}function adjustiFrame(g,b){var d=(navigator.userAgent.toLowerCase().indexOf("opera")!=-1);if(d){return}try{if(!document.getElementById(iFrameDivID)){var c=document.createElement("iFrame");c.setAttribute("id",iFrameDivID);c.setAttribute("src","javascript:false;");c.setAttribute("scrolling","no");c.setAttribute("frameborder","0");document.body.appendChild(c)}if(!g){g=document.getElementById(datePickerDivID)}if(!b){b=document.getElementById(iFrameDivID)}try{b.style.position="absolute";b.style.width=g.offsetWidth;b.style.height=g.offsetHeight;b.style.top=g.style.top;b.style.left=g.style.left;b.style.zIndex=g.style.zIndex-1;b.style.visibility=g.style.visibility;b.style.display=g.style.display}catch(f){}}catch(a){}};