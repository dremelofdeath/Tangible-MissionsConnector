var datePickerDivID="datepicker";var iFrameDivID="datepickeriframe";var dayArrayShort=new Array("Su","Mo","Tu","We","Th","Fr","Sa");var dayArrayMed=new Array("Sun","Mon","Tue","Wed","Thu","Fri","Sat");var dayArrayLong=new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday");var monthArrayShort=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec");var monthArrayMed=new Array("Jan","Feb","Mar","Apr","May","June","July","Aug","Sept","Oct","Nov","Dec");var monthArrayLong=new Array("January","February","March","April","May","June","July","August","September","October","November","December");var defaultDateSeparator="/";var defaultDateFormat="mdy";var dateSeparator=defaultDateSeparator;var dateFormat=defaultDateFormat;function displayDatePicker(d,g,b,f){var e=document.getElementsByName(d).item(0);if(!g){g=e}if(f){dateSeparator=f}else{dateSeparator=defaultDateSeparator}if(b){dateFormat=b}else{dateFormat=defaultDateFormat}var a=g.offsetLeft;var h=g.offsetTop+g.offsetHeight;var c=g;while(c.offsetParent){c=c.offsetParent;a+=c.offsetLeft;h+=c.offsetTop}drawDatePicker(e,a,h)}function drawDatePicker(e,a,f){var c=getFieldDate(e.value);if(!document.getElementById(datePickerDivID)){var b=document.createElement("div");b.setAttribute("id",datePickerDivID);b.setAttribute("class","dpDiv");b.setAttribute("style","visibility: hidden;");document.body.appendChild(b)}var d=document.getElementById(datePickerDivID);d.style.position="absolute";d.style.left=a+"px";d.style.top=f+"px";d.style.visibility=(d.style.visibility=="visible"?"hidden":"visible");d.style.display=(d.style.display=="block"?"none":"block");d.style.zIndex=10000;refreshDatePicker(e.name,c.getFullYear(),c.getMonth(),c.getDate())}function refreshDatePicker(v,o,z,s){var h=new Date();if((z>=0)&&(o>0)){h=new Date(o,z,1)}else{s=h.getDate();h.setDate(1)}var l="\r\n";var m="<table cols=7 class='dpTable'>"+l;var j="</table>"+l;var w="<tr class='dpTR'>";var g="<tr class='dpTitleTR'>";var b="<tr class='dpDayTR'>";var a="<tr class='dpTodayButtonTR'>";var e="</tr>"+l;var c="<td class='dpTD' onMouseOut='this.className=\"dpTD\";' onMouseOver=' this.className=\"dpTDHover\";' ";var k="<td colspan=5 class='dpTitleTD'>";var t="<td class='dpButtonTD'>";var r="<td colspan=7 class='dpTodayButtonTD'>";var y="<td class='dpDayTD'>";var A="<td class='dpDayHighlightTD' onMouseOut='this.className=\"dpDayHighlightTD\";' onMouseOver='this.className=\"dpTDHover\";' ";var q="</td>"+l;var d="<div class='dpTitleText'>";var u="<div class='dpDayHighlight'>";var p="</div>";var n=m;n+=g;n+=t+getButtonCode(v,h,-1,"&lt;")+q;n+=k+d+monthArrayLong[h.getMonth()]+" "+h.getFullYear()+p+q;n+=t+getButtonCode(v,h,1,"&gt;")+q;n+=e;n+=b;for(i=0;i<dayArrayShort.length;i++){n+=y+dayArrayShort[i]+q}n+=e;n+=w;for(i=0;i<h.getDay();i++){n+=c+"&nbsp;"+q}do{dayNum=h.getDate();TD_onclick=" onclick=\"updateDateField('"+v+"', '"+getDateString(h)+"');\">";if(dayNum==s){n+=A+TD_onclick+u+dayNum+p+q}else{n+=c+TD_onclick+dayNum+q}if(h.getDay()==6){n+=e+w}h.setDate(h.getDate()+1)}while(h.getDate()>1);if(h.getDay()>0){for(i=6;i>h.getDay();i--){n+=c+"&nbsp;"+q}}n+=e;var x=new Date();var f="Today is "+dayArrayMed[x.getDay()]+", "+monthArrayMed[x.getMonth()]+" "+x.getDate();n+=a+r;n+="<button class='dpTodayButton' onClick='refreshDatePicker(\""+v+"\");'>this month</button> ";n+="<button class='dpTodayButton' onClick='updateDateField(\""+v+"\");'>close</button>";n+=q+e;n+=j;document.getElementById(datePickerDivID).innerHTML=n;adjustiFrame()}function getButtonCode(d,a,f,c){var e=(a.getMonth()+f)%12;var b=a.getFullYear()+parseInt((a.getMonth()+f)/12);if(e<0){e+=12;b+=-1}return"<button class='dpButton' onClick='refreshDatePicker(\""+d+'", '+b+", "+e+");'>"+c+"</button>"}function getDateString(b){var a="00"+b.getDate();var c="00"+(b.getMonth()+1);a=a.substring(a.length-2);c=c.substring(c.length-2);switch(dateFormat){case"dmy":return a+dateSeparator+c+dateSeparator+b.getFullYear();case"ymd":return b.getFullYear()+dateSeparator+c+dateSeparator+a;case"mdy":default:return c+dateSeparator+a+dateSeparator+b.getFullYear()}}function getFieldDate(f){var c;var b;var h,a,j;try{b=splitDateString(f);if(b){switch(dateFormat){case"dmy":h=parseInt(b[0],10);a=parseInt(b[1],10)-1;j=parseInt(b[2],10);break;case"ymd":h=parseInt(b[2],10);a=parseInt(b[1],10)-1;j=parseInt(b[0],10);break;case"mdy":default:h=parseInt(b[1],10);a=parseInt(b[0],10)-1;j=parseInt(b[2],10);break}c=new Date(j,a,h)}else{if(f){c=new Date(f)}else{c=new Date()}}}catch(g){c=new Date()}return c}function splitDateString(b){var a;if(b.indexOf("/")>=0){a=b.split("/")}else{if(b.indexOf(".")>=0){a=b.split(".")}else{if(b.indexOf("-")>=0){a=b.split("-")}else{if(b.indexOf("\\")>=0){a=b.split("\\")}else{a=false}}}}return a}function updateDateField(b,a){var d=document.getElementsByName(b).item(0);if(a){d.value=a}var c=document.getElementById(datePickerDivID);c.style.visibility="hidden";c.style.display="none";adjustiFrame();d.focus();if((a)&&(typeof(datePickerClosed)=="function")){datePickerClosed(d)}}function adjustiFrame(g,b){var d=(navigator.userAgent.toLowerCase().indexOf("opera")!=-1);if(d){return}try{if(!document.getElementById(iFrameDivID)){var c=document.createElement("iFrame");c.setAttribute("id",iFrameDivID);c.setAttribute("src","javascript:false;");c.setAttribute("scrolling","no");c.setAttribute("frameborder","0");document.body.appendChild(c)}if(!g){g=document.getElementById(datePickerDivID)}if(!b){b=document.getElementById(iFrameDivID)}try{b.style.position="absolute";b.style.width=g.offsetWidth;b.style.height=g.offsetHeight;b.style.top=g.style.top;b.style.left=g.style.left;b.style.zIndex=g.style.zIndex-1;b.style.visibility=g.style.visibility;b.style.display=g.style.display}catch(f){}}catch(a){}};